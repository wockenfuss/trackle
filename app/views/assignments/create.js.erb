$('#task-modal').dialog( "close" );

refreshTaskBox('<%= @assignment.task.id %>');

//refresh div of user
var userId = '<%= @assignment.user.id %>';
var userSelector = 'div[data-user="' + userId + '"]';

refreshUserBox(userId);

myApp.setTaskColor();
myApp.setCityColor();
myApp.droppable(userSelector);
myApp.bindUserModal(userSelector);

function refreshTaskBox(taskId) {
	var $div = $('div[data-task="' + taskId + '"]');
	var html = '<%= j render :partial => "tasks/show", :locals => { :task => @assignment.task, :city => @assignment.city } %>';
	$div.replaceWith(html);
	//make task draggable
	myApp.draggable('div[data-task="' + taskId + '"]');
};

function refreshUserBox(userId) {
	var userHtml = '<%= j render :partial => "users/box", :locals => { :user => @assignment.user } %>';
	$('div[data-user="' + userId + '"]').replaceWith(userHtml);
}